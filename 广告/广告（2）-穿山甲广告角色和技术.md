**字节跳动的「穿山甲联盟（Pangolin）」**（2018 年推出）  
   → 是**广告变现平台**，面向 App 开发者提供**广告 SDK 接入、流量聚合、程序化变现**能力，属于**广告技术（AdTech）领域**。

---

**该广告平台的技术架构**

---

## 一、穿山甲（Pangolin）定位与核心目标

- **定位**：字节跳动推出的**第三方移动广告聚合平台**，帮助非字节系 App（如工具类、游戏、短剧、资讯类）实现高效广告变现。
- **核心价值**：
  - 聚合字节系高 eCPM 流量（抖音、今日头条等广告主预算）
  - 支持多广告源混合竞价（Waterfall + Header Bidding）
  - 提供全场景广告形式（开屏、插屏、激励视频、信息流、原生等）
  - 深度优化填充率与收益（宣称填充率 ≥95%，eCPM 行业领先）

---

## 二、整体技术架构（分层模型）

穿山甲的技术架构可划分为 **客户端（SDK 层）** 与 **服务端（平台层）** 两大体系：

```
+--------------------------------------------------+
|                Advertiser (品牌/效果)             |
|        (通过巨量引擎投放至穿山甲流量)            |
+----------------------+---------------------------+
                       ↓
+--------------------------------------------------+
|           穿山甲服务端平台（Server-Side）         |
|  ┌─────────────┐  ┌─────────────┐  ┌───────────┐ |
|  │  Ad Exchange│  │ Real-Time   │  │ Yield     │ |
|  │  / Auction  │←→│ Bidding     │←→│ Management│ |
|  │  Engine     │  │ (RTB)       │  │ & Waterfall│|
|  └─────────────┘  └─────────────┘  └───────────┘ |
|        ↑                ↑                ↑        |
|  ┌─────────────┐  ┌─────────────┐  ┌───────────┐ |
|  │  DMP /      │  │ Fraud &     │  │ Reporting │ |
|  │  Audience   │  │ Brand Safety│  │ & Analytics│|
|  │  Segmentation│ │ (3PV-like)  │  │           │ |
|  └─────────────┘  └─────────────┘  └───────────┘ |
+----------------------+---------------------------+
                       ↓ (Bid Response / Ad Creative)
+--------------------------------------------------+
|           客户端 SDK（Publisher App 内）          |
|  ┌────────────────────────────────────────────┐  |
|  │  Pangolin SDK (Android / iOS)              │  |
|  │  ├─ Ad Request Manager                     │  |
|  │  ├─ Mediation Layer (支持多平台混合)       │  |
|  │  ├─ Ad Cache & Preload                     │  |
|  │  ├─ Rendering Engine (WebView / Native)    │  |
|  │  ├─ Event Tracker (曝光/点击/转化)         │  |
|  │  └─ Privacy Compliance (权限/授权管理)      │  |
|  └────────────────────────────────────────────┘  |
+--------------------------------------------------+
|                Publisher (App 开发者)             |
+--------------------------------------------------+
```

---

## 三、关键技术模块详解

### 1. **客户端 SDK 架构（Publisher 侧）**

#### （1）**统一广告请求接口**
- 开发者调用 `loadInterstitialAd()`、`showRewardVideoAd()` 等标准 API。
- SDK 自动处理网络、缓存、生命周期管理。

#### （2）**混合竞价（Mediation）引擎**
- 支持 **Waterfall（瀑布流）** 与 **Bidding（实时竞价）** 混合模式：
  - **Waterfall**：按预设优先级依次向各广告平台请求（如穿山甲 → 优量汇 → 快手）
  - **Bidding**：并行向多个 DSP 发起 RTB 请求，取最高价胜出（类似 Prebid）
- 穿山甲自身作为**最高优先级广告源**，因其 eCPM 通常最优。

#### （3）**广告预加载与缓存**
- 在用户进入可能触发广告的页面前（如游戏关卡加载），提前请求广告素材。
- 支持视频广告本地缓存，减少加载延迟，提升展示率。

#### （4）**渲染引擎**
- 支持多种广告形式：
  - **开屏广告**：全屏 WebView 或原生组件
  - **激励视频**：H.264 视频 + 倒计时 + 跳过逻辑
  - **信息流/原生**：动态模板 + JSON 配置，适配不同 UI 风格
- 渲染过程隔离于主 App 进程，防止崩溃影响宿主。

#### （5）**事件追踪与归因**
- 自动上报：曝光（Impression）、点击（Click）、关闭（Close）、奖励发放（Reward Granted）
- 支持**服务器回调（Server-to-Server Callback）**，用于防作弊与精准归因。

#### （6）**隐私与合规模块**
- 自动检测 Android 权限（如 READ_PHONE_STATE）
- 集成 **OAID（匿名设备标识）** 替代 IMEI
- 支持 GDPR/CCPA 式用户授权弹窗（在中国主要响应《个保法》要求）

---

### 2. **服务端平台架构（Pangolin 后台）**

#### （1）**实时竞价引擎（RTB Engine）**
- 接收来自 Publisher SDK 的广告请求（含设备信息、位置、上下文等）
- 向字节内部 DSP（巨量引擎）及其他合作 DSP 发起竞价
- 采用 **毫秒级响应**（目标 < 150ms），保障用户体验

#### （2）**广告交易平台（Ad Exchange）**
- 聚合字节系广告主预算（品牌 + 效果）
- 支持多种计费模式：CPC、CPM、oCPM、CPS（激励视频）
- 动态底价（Floor Price）策略：基于 LTV、留存率、地域等调整

#### （3）**反作弊与品牌安全（Fraud & Safety）**
- 设备指纹识别（模拟器、刷量群控）
- IP 聚类分析（异常点击集中）
- 广告内容审核（AI + 人工，过滤违规素材）
- 与第三方验证（如秒针、国双）合作，但主要依赖自研系统

#### （4）**数据中台与 DMP**
- 基于字节 5.5 亿 DAU 行为数据构建用户标签
- 支持 Lookalike 扩量、兴趣定向、LBS 定向
- 与巨量云图打通，实现跨端（抖音+外部 App）人群协同

#### （5）**报表与 BI 系统**
- 实时展示：展示量、点击率、eCPM、填充率、收益
- 支持按广告位、渠道、版本、地域等多维下钻
- 提供“收益诊断”建议（如“激励视频频控过严，可提升20%收益”）

---

## 四、穿山甲的独特技术优势

| 优势 | 技术实现 |
|------|--------|
| **高 eCPM** | 背靠字节广告主预算池，尤其电商、游戏、短剧类需求旺盛 |
| **低延迟** | 全球 CDN + 边缘计算节点，广告素材就近分发 |
| **高填充率** | 多广告源兜底 + 字节自有流量保障 |
| **强反作弊** | 自研设备指纹 + 行为序列建模，拦截率 >99% |
| **开发者友好** | 一键接入、自动更新、崩溃率 <0.1%（官方数据） |

---

## 五、典型应用场景示例

### 场景：短剧 App 激励视频变现
1. 用户观看第3集后弹出“看广告解锁下一集”
2. SDK 预加载穿山甲激励视频（eCPM ≈ ¥25）
3. 用户看完 → SDK 上报“rewardGranted=true”
4. 穿山甲服务端验证行为真实性 → 结算 ¥0.3/次
5. 同时记录用户为“高价值观众”，后续推送更高单价广告

---

## 六、总结

穿山甲（Pangolin）的技术架构体现了**中国广告生态的核心逻辑**：
- **以平台为中心**：字节通过 SDK 深度控制流量入口
- **数据闭环驱动**：利用内部用户行为数据优化外部流量变现
- **极致性能优化**：从预加载到反作弊，一切为 eCPM 服务
- **合规内嵌**：隐私、未成年人保护等要求直接集成到 SDK

它不仅是广告 SDK，更是一个**集 Mediation、RTB、DMP、Anti-fraud、BI 于一体的移动变现操作系统**。

---