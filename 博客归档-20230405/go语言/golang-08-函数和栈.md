- 函数是程序中为了执行特定任务而存在的一系列执行代码。函数接受输入并返回输出，执行程序的过程可以看作一系列函数的调用过程。Go语言中最重要的函数为main函数，其是程序执行用户代码的入口，在每个程序中都需要存在。


# golang 中函数是一等公民

- 函数是程序中为了执行特定任务而存在的一系列执行代码。函数接受输入并返回输出，执行程序的过程可以看作一系列函数的调用过程。Go语言中最重要的函数为main函数，其是程序执行用户代码的入口，在每个程序中都需要存在。

- 函数是程序中为了执行特定任务而存在的一系列执行代码。函数接受输入并返回输出，执行程序的过程可以看作一系列函数的调用过程。Go语言中最重要的函数为main函数，其是程序执行用户代码的入口，在每个程序中都需要存在。

# golang 函数闭包和陷阱


```golang
func TestFunc() {
	// 这样会一直输出5
	for _, val := range []int64{1, 2, 3, 4, 5} {
		go func() {
			fmt.Printf("case 1 : %d\n", val)
		}()
	}
	// 这样会一直输出5
	for _, val := range []int64{1, 2, 3, 4, 5} {
		go func() {
			val := val
			fmt.Printf("case 2 : %d\n", val)
		}()
	}
	// 输出 1,2,3,4,5
	for _, val := range []int64{1, 2, 3, 4, 5} {
		go func(val int64) {
			fmt.Printf("case 3 : %d\n", val)
		}(val)
	}

	time.Sleep(time.Second * 3)
}
```

> 这也是Go语言中一类非常经典的错误，被收录在了Go语言“共同的错误”[2]中，最终协程会打印出values切片的最后一个值。因为当前val值引用的是同一个地址的数据，所以在range循环的过程中，会不断在val地址中更新数据。而在闭包中，由于引用了外部变量val，所以在访问时会获取val地址中的值，可能会获取最后放入其中的值，而不是遍历所有值，从而导致严重的错误。

> 注意这种情况， 需要使用传参 来规避 ， 或者使用trace 工具来处理

# golang 函数栈

就是传统计算机理论中的函数栈 > 每个函数在执行过程中都使用一块栈内存来保存返回地址、局部变量、函数参数等，我们将这一块区域称为函数的栈帧（stack frame）。

# golang 堆栈信息 -> todo

# golang 函数栈扩容和栈转移 -> todo

# golang 栈调试 -> todo

